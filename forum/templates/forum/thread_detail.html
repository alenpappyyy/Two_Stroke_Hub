{% extends "forum/base_forum.html" %}
{% block forum_content %}
<h1 class="text-2xl font-bold">{{ thread.title }}</h1>
<p class="text-sm text-gray-500 mb-4">in <a href="{% url 'forum:category_detail' thread.category.slug %}">{{ thread.category.name }}</a> â€¢ by {{ thread.creator }}</p>

<div class="space-y-6">
  {% for post in posts %}
  <div id="post-{{ post.id }}" class="p-4 border rounded">
    <div class="flex justify-between items-start">
      <div>
        <div class="font-semibold">{{ post.author }}</div>
        <div class="text-sm text-gray-500">{{ post.created_at|date:"M j, Y H:i" }}</div>
      </div>
      <div class="text-sm text-gray-500">votes: {{ post.votes.aggregate_total|default:post.votes.aggregate_total }}</div>
    </div>

    <div class="mt-3 whitespace-pre-wrap">{{ post.content }}</div>

    <div class="mt-3">
      <form method="post" action="{% url 'forum:create_reply' post.id thread.category.slug thread.slug %}" class="space-y-2">
        {% csrf_token %}
        {{ reply_form.as_p }}
        <button class="bg-blue-600 px-3 py-1 rounded">Reply</button>
      </form>
    </div>
  </div>
  {% empty %}
  <p>No posts yet.</p>
  {% endfor %}
</div>

<hr class="my-6">

<h3 class="text-xl mb-2">Add a new post</h3>
<form method="post" action="{% url 'forum:create_post' thread.category.slug thread.slug %}">
  {% csrf_token %}
  {{ post_form.as_p }}
  <button class="bg-green-600 px-4 py-2 rounded">Post</button>
</form>

{% endblock %}
